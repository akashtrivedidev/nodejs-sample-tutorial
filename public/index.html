<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NodeTasker - Task Management API</title>
  <style>
    :root {
      --primary: #3B82F6;
      --primary-dark: #2563EB;
      --secondary: #14B8A6;
      --accent: #F97316;
      --success: #22C55E;
      --warning: #F59E0B;
      --error: #EF4444;
      --gray-50: #F9FAFB;
      --gray-100: #F3F4F6;
      --gray-200: #E5E7EB;
      --gray-300: #D1D5DB;
      --gray-400: #9CA3AF;
      --gray-500: #6B7280;
      --gray-600: #4B5563;
      --gray-700: #374151;
      --gray-800: #1F2937;
      --gray-900: #111827;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      line-height: 1.5;
      color: var(--gray-800);
      background-color: var(--gray-50);
    }

    header {
      background: var(--primary);
      color: white;
      padding: 16px;
      text-align: center;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }

    main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 24px 16px;
    }

    h1 {
      margin-bottom: 8px;
      font-weight: 700;
    }

    h2 {
      margin: 24px 0 16px;
      color: var(--gray-800);
      font-weight: 600;
    }

    p {
      margin-bottom: 16px;
      color: var(--gray-600);
    }

    .card {
      background: white;
      border-radius: 8px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      padding: 24px;
      margin-bottom: 24px;
    }

    .form-group {
      margin-bottom: 16px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
    }

    input, textarea, select {
      width: 100%;
      padding: 8px;
      border: 1px solid var(--gray-300);
      border-radius: 4px;
      font-size: 1rem;
    }

    button {
      background: var(--primary);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background: var(--primary-dark);
    }

    button.secondary {
      background: var(--gray-200);
      color: var(--gray-800);
    }

    button.secondary:hover {
      background: var(--gray-300);
    }

    button.danger {
      background: var(--error);
    }

    button.danger:hover {
      background: #DC2626;
    }

    .task-list {
      list-style: none;
    }

    .task-item {
      background: white;
      border-radius: 4px;
      padding: 16px;
      margin-bottom: 8px;
      border-left: 4px solid var(--primary);
      display: flex;
      justify-content: space-between;
      align-items: center;
      animation: fadeIn 0.3s ease-in-out;
    }

    .task-item:hover {
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .task-item.completed {
      border-left-color: var(--success);
      opacity: 0.7;
    }

    .task-item.completed .task-title {
      text-decoration: line-through;
    }

    .task-item.high-priority {
      border-left-color: var(--error);
    }

    .task-item.medium-priority {
      border-left-color: var(--warning);
    }

    .task-item.low-priority {
      border-left-color: var(--secondary);
    }

    .task-actions {
      display: flex;
      gap: 8px;
    }

    .badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 16px;
      font-size: 0.75rem;
      font-weight: 500;
      margin-left: 8px;
    }

    .badge.high {
      background: #FEE2E2;
      color: #B91C1C;
    }

    .badge.medium {
      background: #FEF3C7;
      color: #92400E;
    }

    .badge.low {
      background: #D1FAE5;
      color: #065F46;
    }

    .api-section {
      background: var(--gray-800);
      color: white;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 24px;
      overflow-x: auto;
    }

    code {
      font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
      font-size: 0.9rem;
    }

    pre {
      background: var(--gray-900);
      padding: 16px;
      border-radius: 4px;
      overflow-x: auto;
    }

    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100px;
    }

    .loading:after {
      content: " ";
      display: block;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      border: 6px solid var(--primary);
      border-color: var(--primary) transparent var(--primary) transparent;
      animation: loader 1.2s linear infinite;
    }

    @keyframes loader {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(8px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
      border-bottom: 1px solid var(--gray-200);
      padding-bottom: 8px;
    }

    .tab {
      padding: 8px 16px;
      background: transparent;
      border: none;
      border-radius: 4px;
      color: var(--gray-600);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .tab.active {
      background: var(--primary);
      color: white;
    }

    .tab-content {
      display: none;
      animation: fadeIn 0.3s ease;
    }

    .tab-content.active {
      display: block;
    }

    .message {
      padding: 16px;
      border-radius: 4px;
      margin-bottom: 16px;
      font-weight: 500;
    }

    .message.success {
      background: #ECFDF5;
      color: #065F46;
      border-left: 4px solid var(--success);
    }

    .message.error {
      background: #FEF2F2;
      color: #B91C1C;
      border-left: 4px solid var(--error);
    }

    /* Responsive styles */
    @media (max-width: 768px) {
      main {
        padding: 16px 8px;
      }
      
      .card {
        padding: 16px;
      }
      
      .task-actions {
        flex-direction: column;
      }
    }

    @media (min-width: 768px) {
      .form-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>NodeTasker</h1>
    <p>A beginner-friendly Node.js task management API</p>
  </header>

  <main>
    <div class="tabs">
      <button class="tab active" data-tab="app">Task App</button>
      <button class="tab" data-tab="api">API Documentation</button>
      <button class="tab" data-tab="concepts">Node.js Concepts</button>
    </div>

    <div id="message-container"></div>

    <section id="app-tab" class="tab-content active">
      <div class="card">
        <h2>Add a New Task</h2>
        <form id="task-form">
          <div class="form-grid">
            <div class="form-group">
              <label for="title">Task Title*</label>
              <input type="text" id="title" name="title" required>
            </div>
            
            <div class="form-group">
              <label for="priority">Priority</label>
              <select id="priority" name="priority">
                <option value="low">Low</option>
                <option value="medium" selected>Medium</option>
                <option value="high">High</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label for="description">Description</label>
            <textarea id="description" name="description" rows="3"></textarea>
          </div>

          <button type="submit">Add Task</button>
        </form>
      </div>

      <div class="card">
        <h2>Your Tasks</h2>
        <div id="tasks-container">
          <div class="loading"></div>
        </div>
      </div>
    </section>

    <section id="api-tab" class="tab-content">
      <div class="card">
        <h2>API Endpoints</h2>
        <p>NodeTasker provides a RESTful API for managing tasks. Here are the available endpoints:</p>

        <div class="api-section">
          <h3>GET /api/tasks</h3>
          <p>Retrieves all tasks</p>
          <pre><code>fetch('/api/tasks')
  .then(response => response.json())
  .then(data => console.log(data));</code></pre>
        </div>

        <div class="api-section">
          <h3>GET /api/tasks/:id</h3>
          <p>Retrieves a specific task by ID</p>
          <pre><code>fetch('/api/tasks/1234')
  .then(response => response.json())
  .then(data => console.log(data));</code></pre>
        </div>

        <div class="api-section">
          <h3>POST /api/tasks</h3>
          <p>Creates a new task</p>
          <pre><code>fetch('/api/tasks', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    title: 'Learn Node.js',
    description: 'Study core concepts',
    priority: 'high',
    completed: false
  })
})
  .then(response => response.json())
  .then(data => console.log(data));</code></pre>
        </div>

        <div class="api-section">
          <h3>PUT /api/tasks/:id</h3>
          <p>Updates an existing task</p>
          <pre><code>fetch('/api/tasks/1234', {
  method: 'PUT',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    title: 'Updated task title',
    completed: true
  })
})
  .then(response => response.json())
  .then(data => console.log(data));</code></pre>
        </div>

        <div class="api-section">
          <h3>DELETE /api/tasks/:id</h3>
          <p>Deletes a task</p>
          <pre><code>fetch('/api/tasks/1234', {
  method: 'DELETE'
})
  .then(response => response.json())
  .then(data => console.log(data));</code></pre>
        </div>
      </div>
    </section>

    <section id="concepts-tab" class="tab-content">
      <div class="card">
        <h2>Node.js Concepts Demonstrated</h2>
        
        <h3>Non-blocking I/O</h3>
        <p>Node.js uses non-blocking I/O operations, allowing it to handle many connections concurrently without creating separate threads. This project demonstrates this with asynchronous file operations using <code>fs.promises</code>.</p>
        
        <h3>File System Operations</h3>
        <p>The project uses the Node.js <code>fs</code> module to read and write task data to a JSON file, demonstrating file persistence without a database.</p>
        
        <h3>Event-Driven Architecture</h3>
        <p>Node.js uses an event-driven architecture where certain actions trigger events that can be listened for. The TaskEvent system demonstrates this by emitting events when tasks are created, updated, or deleted.</p>
        
        <h3>HTTP and Express</h3>
        <p>The project uses Express.js, a popular web framework for Node.js, to create a RESTful API with routes, middleware, and request/response handling.</p>
        
        <h3>Middleware Pattern</h3>
        <p>Middleware functions in Express process requests before they reach route handlers, as demonstrated by the error handling and logging middleware.</p>
        
        <h3>JSON File-Based Storage</h3>
        <p>Instead of using a database, this project stores data in a JSON file, which is a common pattern for simple applications or prototypes.</p>
        
        <h3>Error Handling</h3>
        <p>The project implements comprehensive error handling using try/catch blocks and Express error middleware to ensure graceful error responses.</p>
      </div>

      <div class="card">
        <h2>Extension Ideas</h2>
        <p>Ways to expand this project to learn more Node.js concepts:</p>
        <ul>
          <li>Add user authentication with JWT tokens</li>
          <li>Implement task categories or tags</li>
          <li>Add due dates and reminders using cron jobs</li>
          <li>Create a more advanced front-end with a framework</li>
          <li>Implement server-sent events for real-time updates</li>
          <li>Add data validation with a library like Joi</li>
          <li>Migrate to a real database like MongoDB or PostgreSQL</li>
          <li>Add unit and integration tests</li>
        </ul>
      </div>
    </section>
  </main>

  <script>
    // Task management functionality
    document.addEventListener('DOMContentLoaded', () => {
      const tasksContainer = document.getElementById('tasks-container');
      const taskForm = document.getElementById('task-form');
      const messageContainer = document.getElementById('message-container');
      
      // Tab functionality
      const tabs = document.querySelectorAll('.tab');
      const tabContents = document.querySelectorAll('.tab-content');
      
      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          // Remove active class from all tabs
          tabs.forEach(t => t.classList.remove('active'));
          tabContents.forEach(content => content.classList.remove('active'));
          
          // Add active class to clicked tab
          tab.classList.add('active');
          document.getElementById(`${tab.dataset.tab}-tab`).classList.add('active');
        });
      });
      
      // Show a message (success or error)
      const showMessage = (text, type = 'success') => {
        messageContainer.innerHTML = `<div class="message ${type}">${text}</div>`;
        
        // Clear the message after 3 seconds
        setTimeout(() => {
          messageContainer.innerHTML = '';
        }, 3000);
      };
      
      // Fetch all tasks
      const fetchTasks = async () => {
        tasksContainer.innerHTML = '<div class="loading"></div>';
        
        try {
          const response = await fetch('/api/tasks');
          
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          
          const data = await response.json();
          
          if (data.data.tasks.length === 0) {
            tasksContainer.innerHTML = '<p>No tasks found. Add your first task above!</p>';
            return;
          }
          
          // Render tasks
          renderTasks(data.data.tasks);
        } catch (error) {
          console.error('Error fetching tasks:', error);
          tasksContainer.innerHTML = `<p>Error loading tasks: ${error.message}</p>`;
        }
      };
      
      // Render tasks to the DOM
      const renderTasks = (tasks) => {
        const taskList = document.createElement('ul');
        taskList.className = 'task-list';
        
        tasks.forEach((task) => {
          const taskItem = document.createElement('li');
          taskItem.className = `task-item ${task.completed ? 'completed' : ''} ${task.priority}-priority`;
          
          const taskContent = document.createElement('div');
          taskContent.className = 'task-content';
          
          const taskTitle = document.createElement('h3');
          taskTitle.className = 'task-title';
          taskTitle.textContent = task.title;
          
          const priorityBadge = document.createElement('span');
          priorityBadge.className = `badge ${task.priority}`;
          priorityBadge.textContent = task.priority;
          taskTitle.appendChild(priorityBadge);
          
          taskContent.appendChild(taskTitle);
          
          if (task.description) {
            const taskDescription = document.createElement('p');
            taskDescription.textContent = task.description;
            taskContent.appendChild(taskDescription);
          }
          
          const taskActions = document.createElement('div');
          taskActions.className = 'task-actions';
          
          // Toggle completion button
          const toggleButton = document.createElement('button');
          toggleButton.className = 'secondary';
          toggleButton.textContent = task.completed ? 'Mark Incomplete' : 'Mark Complete';
          toggleButton.addEventListener('click', () => toggleTaskCompletion(task.id, !task.completed));
          
          // Delete button
          const deleteButton = document.createElement('button');
          deleteButton.className = 'danger';
          deleteButton.textContent = 'Delete';
          deleteButton.addEventListener('click', () => deleteTask(task.id));
          
          taskActions.appendChild(toggleButton);
          taskActions.appendChild(deleteButton);
          
          taskItem.appendChild(taskContent);
          taskItem.appendChild(taskActions);
          taskList.appendChild(taskItem);
        });
        
        tasksContainer.innerHTML = '';
        tasksContainer.appendChild(taskList);
      };
      
      // Toggle task completion status
      const toggleTaskCompletion = async (id, completed) => {
        try {
          const response = await fetch(`/api/tasks/${id}`, {
            method: 'PUT',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ completed })
          });
          
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          
          // Refresh tasks
          fetchTasks();
          showMessage(`Task ${completed ? 'completed' : 'marked as incomplete'}`);
        } catch (error) {
          console.error('Error updating task:', error);
          showMessage(`Error updating task: ${error.message}`, 'error');
        }
      };
      
      // Delete a task
      const deleteTask = async (id) => {
        if (!confirm('Are you sure you want to delete this task?')) {
          return;
        }
        
        try {
          const response = await fetch(`/api/tasks/${id}`, {
            method: 'DELETE'
          });
          
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          
          // Refresh tasks
          fetchTasks();
          showMessage('Task deleted successfully');
        } catch (error) {
          console.error('Error deleting task:', error);
          showMessage(`Error deleting task: ${error.message}`, 'error');
        }
      };
      
      // Handle form submission
      taskForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const title = document.getElementById('title').value;
        const description = document.getElementById('description').value;
        const priority = document.getElementById('priority').value;
        
        try {
          const response = await fetch('/api/tasks', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              title,
              description,
              priority
            })
          });
          
          if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.message || `HTTP error! status: ${response.status}`);
          }
          
          // Reset form
          taskForm.reset();
          
          // Refresh tasks
          fetchTasks();
          showMessage('Task created successfully');
        } catch (error) {
          console.error('Error creating task:', error);
          showMessage(`Error creating task: ${error.message}`, 'error');
        }
      });
      
      // Initial fetch
      fetchTasks();
    });
  </script>
</body>
</html>